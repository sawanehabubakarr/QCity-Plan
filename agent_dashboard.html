<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agent Dashboard</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Boxicons -->
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org@1.9.12" defer></script>
  <link rel="stylesheet" href="styles.css">
</head>

<!--
If Quality Activations is within a range Then h3 with id Level text is set to level: (Quality Activations) * NLe level multiplier
0-45 = L1: (Quality Activations) * NLe 1.0
46-80 = L2: (Quality Activations) * NLe 1.1
81-125 = L3: (Quality Activations) * NLe 1.2
126-170 = L4: (Quality Activations) * NLe 1.3
171-215 = L5: (Quality Activations) * NLe 1.4
216-260 = L6: (Quality Activations) * NLe 1.5
-->


<body>

  <!-- Navbar with Toggle -->
  <nav class="navbar navbar-dark bg-dark justify-content-evenly">
    <button class="btn btn-outline-light d-md-none" type="button" data-bs-toggle="offcanvas"
      data-bs-target="#agentSidebar">
      <i class='bx bx-menu'></i>
    </button>
    <h3 id="Level">L5: (175) * Nle 1.4 = 245</h3>
  </nav>

  <div class="d-flex">
    <!-- Sidebar (desktop view) -->
    <div class="offcanvas offcanvas-start bg-dark text-white p-3" tabindex="-1" id="agentSidebar" style="width: 260px;">
      <!-- Header for mobile -->
      <div class="offcanvas-header d-md-none">
        <h5 class="offcanvas-title">Menu</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
      </div>

      <!-- Agent Profile -->
      <div class="mb-4">
        <h5 class="mb-1">Agent: 31 987654</h5>
        <span class="badge bg-success">Active</span>
      </div>

      <!-- Balance -->
      <div class="card bg-secondary text-white mb-3">
        <div class="card-body p-3">
          <h6 class="card-title mb-1">Account Balance</h6>
          <p class="fw-bold mb-0">NLe 3,250</p>
        </div>
      </div>

      <!-- Past Salaries -->
      <h6 class="text-uppercase small text-muted">Past Salaries</h6>
      <ul class="list-group list-group-flush mb-3">
        <li class="list-group-item bg-dark text-white d-flex justify-content-between">
          <span>Aug 2025</span><span>NLe 2,800</span>
        </li>
        <li class="list-group-item bg-dark text-white d-flex justify-content-between">
          <span>Jul 2025</span><span>NLe 2,750</span>
        </li>
        <li class="list-group-item bg-dark text-white d-flex justify-content-between">
          <span>Jun 2025</span><span>NLe 2,600</span>
        </li>
      </ul>
    </div>

    <!-- Main Content -->
    <div class="flex-grow-1">
      <div class="container mt-2">


        <div class="container mt-3">
          <h5 class="text-center" style="color: black;">Monthly Target: 96</h5>
          <!-- Fix Target of 96 -->
          <div class="progress mb-2" style="height:20px;padding: 0px;">
            <div class="progress-bar fw-bold" style="width:100%; background-color: #fd9b31; ">100%</div>
          </div>

          <!-- Quality Activationss -->
          <div class="row g-3 mb-4">
            <div class="col-md-3 col-12 text-center">
              <div class="card p-3 kpi">
                <div class="text-secondary">Quality Activations</div>
                <div class="fs-3 fw-bold">175</div>
              </div>
            </div>
            <div class="col-md-3 col-12 text-center">
              <div class="card p-3 kpi">
                <div class="text-secondary">Non-Quality Activations</div>
                <div class="fs-3 fw-bold">4</div>
              </div>
            </div>
            <div class="col-md-3 col-6 text-center">
              <div class="card p-3 kpi">
                <div class="text-secondary">Reached Limit</div>
                <div class="fs-3 fw-bold">3</div>
              </div>
            </div>
            <div class="col-md-3 col-6 text-center">
              <div class="card p-3 kpi">
                <div class="text-secondary">Already Done</div>
                <div class="fs-3 fw-bold">1</div>
              </div>
            </div>
          </div>

          <!-- Upload Card -->
          <div class="card p-4 mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h5 class="mb-0"><i class='bx bxs-cloud-upload me-2'></i>New Activation</h5>
              <span class="text-secondary text-end small">Status: <span
                  class="badge bg-warning text-dark">Pending</span></span>
            </div>
            <form id="form-activation" hx-post="api/activations.php" hx-target="#agent-table-body" hx-swap="beforeend"
              enctype="multipart/form-data">
              <div class="row g-3">
                <div class="col-md-4 col-6">
                  <label class="form-label form-section-title">Customer Mobile</label>
                  <input type="tel" name="customer_phone" class="form-control" placeholder="e.g. 31 123456" required>
                </div>
                <div class="col-md-4 col-6">
                  <label class="form-label form-section-title">ID Snapshot</label>
                  <input type="file" name="id_snapshot" class="form-control" accept="image/*" required>
                </div>
                <div class="col-md-4">
                  <label class="form-label form-section-title">Customer Name (OCR / Manual)</label>
                  <input type="text" name="customer_name" class="form-control" placeholder="Full name from ID" required>
                </div>
                <div class="col-12 d-flex gap-2 mt-2">
                  <button class="btn btn-primary"><i class='bx bx-send me-1'></i>Submit</button>
                  <button type="reset" class="btn btn-light">Clear</button>
                </div>
              </div>
            </form>
          </div>

          <!-- Activations Table -->
          <div class="card p-3">
            <h5 class="mb-3"><i class='bx bxs-data me-2'></i>Activations</h5>

            <div class="row gap-1">
              <div class="col-5" style="padding-right: 0px;">
                <label for="startDate" class="small">Start Date</label>
                <input type="date" id="startDate" class="form-control form-control-sm" />
              </div>
              <div class="col-4" style="padding: 0px;">
                <label for="endDate" class="small">End Date</label>
                <input type="date" id="endDate" class="form-control form-control-sm" />
              </div>
              <div class="col p-0 d-flex">
                <button class="btn btn-sm btn-outline-success mt-auto p-1">
                  <i class='bx bx-filter-alt me-1'></i>
                </button>
                <button class="btn btn-sm btn-outline-danger mt-auto p-1">
                  <i class='bx bx-x-circle me-1'></i>
                </button>
              </div>

            </div>

            <!-- Table -->
            <div class="table-responsive">
              <table class="table align-middle">
                <thead>
                  <tr>
                    <th>Phone</th>
                    <th>Status</th>
                    <th>Date</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="agent-table-body">
                  <tr>
                    <td>31 987654</td>
                    <td><span class="badge bg-warning text-dark">Pending</span></td>
                    <td>2025-08-30</td>
                    <td>
                      <!-- This button should only be active is the status = Done -->
                      <button disabled class="btn btn-sm btn-outline-dark p-1" data-bs-toggle="modal"
                        data-bs-target="#RechargeModal">
                        <i class='bx bx-credit-card'></i>
                      </button>
                      <button class="btn btn-sm btn-outline-dark p-1" data-bs-toggle="modal"
                        data-bs-target="#viewIdModal">
                        <i class='bx bx-image-alt'></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- ID Viewer Modal -->
        <div class="modal fade" id="viewIdModal" tabindex="-1">
          <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
              <div class="modal-header border-0">
                <h5 class="modal-title">Mobile: 31987654</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body text-center">
                <img id="modalImg" src="IdCard.png" class="img-fluid rounded" alt="ID" />
              </div>
              <h6 class="px-3 text-center" id="Reference">
                Transaction Id: PP250719.1748.B76546 Transfer Successful to 75927082 CONTEH of transaction amount:
                20.00, charges: 0.87, GST: 0.13. Net debit amount :21.00, your new balance is: 3.37.
              </h6>
            </div>
          </div>
        </div>
        <!-- Recharge Modal -->
        <div class="modal fade" id="RechargeModal" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content p-3 rounded-4 shadow-sm">
              <h5 class="mb-3"><i class='bx bx-credit-card me-2'></i>Record Recharge</h5>
              <form hx-post="/supervisor/recharges" hx-target="#pending-body" hx-swap="outerHTML">
                <input type="hidden" name="activation_id" id="rechargeActivationId">
                <h5 style="color: black;">Amount:</h5>
                <div class="mb-3">
                  <input type="number" class="form-control">
                </div>
                <div class="d-flex gap-2">
                  <button type="submit" class="btn btn-primary"><i class='bx bx-check-circle me-1'></i>Save &
                    Confirm</button>
                  <button type="button" class="btn btn-light border" data-bs-dismiss="modal">Cancel</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>

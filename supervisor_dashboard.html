<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Supervisor Dashboard</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Boxicons -->
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org@1.9.12" defer></script>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="container mt-4">

    <!-- KPIs -->
    <div class="row g-3 mb-4">
      <h3 class="text-center m-0">Target: 500 | Actual: 412</h3>
      <div class="progress" style="height:20px;padding: 0px;">
        <div class="progress-bar fw-bold" style="width:82.4%; background-color: #fd9b31;">82.4%</div>
      </div>
      <div class="col-6 col-md-4 text-center">
        <div class="card kpi">
          <div class="text-secondary">Total Quality Activations</div>
          <div class="fs-3 fw-bold">412</div>
        </div>
      </div>
      <div class="col-6 col-md-4 text-center">
        <div class="card kpi h-100" style="justify-content: center;">
          <div class="text-secondary">Pending</div>
          <div class="fs-3 fw-bold">5</div>
        </div>
      </div>
      <div class="col-12 col-md-4 text-center">
        <div class="card kpi h-100">
          <div class="text-secondary">Top Agent</div>
          <div class="fs-5 fw-bold">Aminata (220)</div>
        </div>
      </div>
    </div>

    <!-- Pending Queue -->
    <div class="card p-3 mb-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="mb-0"><i class='bx bx-time-five me-2'></i>Pending Activations</h5>
        <button class="btn btn-outline-secondary btn-sm" hx-get="/supervisor/pending" hx-target="#pending-body">
          <i class='bx bx-refresh'></i>
        </button>
      </div>
      <div class="table-responsive">
        <table class="table align-middle table-hover">
          <thead>
            <tr>
              <th>Agent</th>
              <th>Phone</th>
              <th>ID</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="pending-body">
            <tr>
              <td>Agent A</td>
              <td>77 987654</td>
              <td>
                <button class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#viewIdModal">
                  <i class='bx bx-image-alt'></i>
                </button>
              </td>
              <td class="d-flex gap-2">
                <!-- Dropdown -->
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Agent Summary -->
    <div class="card p-3">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="mb-0">Agents Performance</h5>
      </div>
      <div class="table-responsive">
        <table class="table align-middle table-hover">
          <thead>
            <tr>
              <th>Agent</th>
              <th>Total</th>
              <th>Drilldown</th>
            </tr>
          </thead>
          <tbody id="agent-summary-body">
            <tr>
              <td>Agent A</td>
              <td>120</td>
              <td>
                <button class="btn btn-sm btn-primary" hx-get="/supervisor/agents/AgentA/activations"
                  hx-target="#drilldown-panel" hx-swap="innerHTML">
                  <i class='bx bx-list-ul me-1'></i>View
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div id="drilldown-panel" class="mt-3"></div>
    </div>
  </div>

  <!-- ID Modal -->
  <div class="modal fade" id="viewIdModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content rounded-4 shadow-sm">
        <div class="modal-header">
          <h5 class="modal-title">Mobile: 31987654</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body text-center">
          <img src="IdCard.png" class="img-fluid rounded" alt="ID" />
        </div>
      </div>
    </div>
  </div>

  <!-- Recharge Modal -->
  <div class="modal fade" id="rechargeModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content p-3 rounded-4 shadow-sm">
        <h5 class="mb-3"><i class='bx bx-credit-card me-2'></i>Record Recharge</h5>
        <form hx-post="/supervisor/recharges" hx-target="#pending-body" hx-swap="outerHTML">
          <input type="hidden" name="activation_id" id="rechargeActivationId">
          <div class="mb-3">
            <label class="form-label">Amount</label>
            <input type="number" name="amount" class="form-control" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Reference</label>
            <input type="text" name="reference" class="form-control" required>
          </div>
          <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary"><i class='bx bx-check-circle me-1'></i>Save & Confirm</button>
            <button type="button" class="btn btn-light border" data-bs-dismiss="modal">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>